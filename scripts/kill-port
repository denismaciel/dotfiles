#! /usr/bin/env bash

# Check if PORT is provided
if [ -z "$PORT" ]; then
    echo "Usage: $0 <port_number>"
    exit 1
fi

# Find the process ID listening on the specified port
PID=$(sudo lsof -t -i:$PORT)

if [ -z "$PID" ]; then
    echo "No process found listening on port $PORT"
    exit 0
fi

# Kill the process
echo "Killing process $PID listening on port $PORT"
sudo kill $PID

# Check if the process was killed
sleep 1
if ps -p $PID > /dev/null; then
    echo "Process did not terminate. Attempting force kill..."
    sudo kill -9 $PID

    # Check again
    sleep 1
    if ps -p $PID > /dev/null; then
        echo "Failed to kill the process."
        exit 1
    else
        echo "Process forcefully terminated."
    fi
else
    echo "Process terminated successfully."
fi
